<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Use Case: KPI Tracking (Posting Issues from a dataframe) • projmgr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Use Case: KPI Tracking (Posting Issues from a dataframe)">
<meta property="og:description" content="projmgr">
<meta property="og:image" content="https://emilyriederer.github.io/projmgr/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-132815709-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-132815709-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">projmgr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Documentation</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../CREDITS.html">Credits</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/emilyriederer/projmgr/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tracking-KPIs_files/header-attrs-2.17/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Use Case: KPI Tracking (Posting Issues from a
dataframe)</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/emilyriederer/projmgr/blob/master/vignettes/tracking-KPIs.Rmd"><code>vignettes/tracking-KPIs.Rmd</code></a></small>
      <div class="hidden name"><code>tracking-KPIs.Rmd</code></div>

    </div>

    
    
<p>The utility of the <code>post</code> functions generally come not
when filing one-off issues but when automating a bulk upload of issues.
One use case for this is when using GitHub as a management platform for
business metrics tracking.</p>
<div id="tracking-kpis" class="section level2">
<h2 class="hasAnchor">
<a href="#tracking-kpis" class="anchor"></a>Tracking KPIs</h2>
<p>As a toy example, suppose an analyst is already using R to report
quarterly sales data and look for anomalous performance. After some
wrangling, suppose their data looks something like this.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">sales_data</span>)
<span class="co">#&gt;      region   month sales_amt sales_expected</span>
<span class="co">#&gt; 1 Northeast October      3144           5000</span>
<span class="co">#&gt; 2 Southeast October      5394           5000</span>
<span class="co">#&gt; 3   Midwest October      4204           4000</span>
<span class="co">#&gt; 4 Southwest October      7442           4000</span>
<span class="co">#&gt; 5 Northwest October      2470           2000</span></pre></body></html></div>
<p>Assume they have some criterion to determine how much of a difference
between actual metrics and expectations warrants further investigation.
For simplicity in this example, we will look at observations exceeding
25% error. In this case, that yield two regions.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">deviations</span> <span class="kw">&lt;-</span> <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">sales_data</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span>(<span class="no">sales_amt</span> - <span class="no">sales_expected</span>) <span class="kw">&gt;=</span> <span class="fl">0.25</span> * <span class="no">sales_expected</span> )
<span class="no">deviations</span>
<span class="co">#&gt;      region   month sales_amt sales_expected</span>
<span class="co">#&gt; 1 Northeast October      3144           5000</span>
<span class="co">#&gt; 2 Southwest October      7442           4000</span></pre></body></html></div>
<p>Using <code><a href="https://purrr.tidyverse.org/reference/map2.html">purrr::pmap_chr()</a></code>, it is easily to automatically
post these issues to a GitHub repository. The result returned is the
number of the GitHub issues posted.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># create custom function to convert dataframe to human-readable issue elements</span>

<span class="no">post_kpis</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">ref</span>, <span class="no">region</span>, <span class="no">month</span>, <span class="no">sales_amt</span>, <span class="no">sales_expected</span>){

  <span class="fu"><a href="../reference/post_issue.html">post_issue</a></span>(<span class="no">ref</span>,
                    <span class="kw">title</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="no">region</span>,
                                  <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">sales_amt</span> <span class="kw">&lt;</span> <span class="no">sales_expected</span>, <span class="st">"below"</span>, <span class="st">"above"</span>),
                                  <span class="st">"sales expectations in"</span>,
                                  <span class="no">month</span>),
                    <span class="kw">body</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(
                      <span class="st">"**Region**: "</span>, <span class="no">region</span>, <span class="st">"\n"</span>,
                      <span class="st">"**Month**: "</span>, <span class="no">month</span>, <span class="st">"\n"</span>,
                      <span class="st">"**Actual**: "</span>, <span class="no">sales_amt</span>, <span class="st">"\n"</span>,
                      <span class="st">"**Expected**: "</span>, <span class="no">sales_expected</span>, <span class="st">"\n"</span>
                    ),
                    <span class="kw">labels</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
                      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"region:"</span>,<span class="no">region</span>),
                      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"month:"</span>,<span class="no">month</span>),
                      <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"dir:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span>(<span class="no">sales_amt</span> <span class="kw">&lt;</span> <span class="no">sales_expected</span>, <span class="st">"below"</span>, <span class="st">"above"</span>))
                    )
  )

}

<span class="co"># post as issues on GitHub </span>
<span class="no">experigit</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/create_repo_ref.html">create_repo_ref</a></span>(<span class="st">'emilyriederer'</span>, <span class="st">'experigit'</span>)
<span class="fu">pmap_chr</span>(<span class="no">deviations</span>, <span class="no">post_kpis</span>, <span class="kw">ref</span> <span class="kw">=</span> <span class="no">experigit</span>)</pre></body></html></div>
<div class="sourceCode" id="cb4"><html><body><pre class="r">#&gt; [1] 158 159</pre></body></html></div>
<p>Results then appear as normal GitHub issues with whatever title,
body, labels, or assignees you chose to specify. From here, various
parties can discuss next steps in the comments, include in milestones,
and ultimate seek to resolve the issue.</p>
<div class="figure">
<img src="post_kpi.PNG" alt=""><p class="caption">Issue created from out-of-bounds metric</p>
</div>
</div>
<div id="a-more-complicated-example" class="section level2">
<h2 class="hasAnchor">
<a href="#a-more-complicated-example" class="anchor"></a>A more complicated example</h2>
<p>The same approach holds up to more complex dataframes comparing more
metrics. Suppose all of your expectations are contained in a “shadow
matrix”, similar to the treatment of missing data described in the <a href="https://arxiv.org/abs/1809.02264"><code>naniar</code>
paper</a>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">performance_data</span>)
<span class="co">#&gt;      region   month sales_actual returns_actual visitors_actual sales_expected</span>
<span class="co">#&gt; 1 Northeast October         3023            310              64           5000</span>
<span class="co">#&gt; 2 Southeast October         5264            505             101           5000</span>
<span class="co">#&gt; 3   Midwest October         4446            407              80           4000</span>
<span class="co">#&gt; 4 Southwest October         7276            706             142           4000</span>
<span class="co">#&gt; 5 Northwest October         2228            201              45           2000</span>
<span class="co">#&gt;   returns_expected visitors_expected</span>
<span class="co">#&gt; 1              300                60</span>
<span class="co">#&gt; 2              200               100</span>
<span class="co">#&gt; 3              400               160</span>
<span class="co">#&gt; 4              700               140</span>
<span class="co">#&gt; 5              200                40</span></pre></body></html></div>
<p>With a bit of data wrangling with <code>tidyr</code>, we can make one
unique record per region, month, and metric.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">performance_pivoted</span> <span class="kw">&lt;-</span>
  <span class="no">performance_data</span> <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html">gather</a></span>(<span class="no">metric</span>, <span class="no">value</span>, -<span class="no">region</span>, -<span class="no">month</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span>(<span class="no">metric</span>, <span class="kw">into</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'metric'</span>, <span class="st">'type'</span>), <span class="kw">sep</span> <span class="kw">=</span> <span class="st">"_"</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">tidyr</span><span class="kw ns">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/spread.html">spread</a></span>(<span class="no">type</span>, <span class="no">value</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">performance_pivoted</span>)
<span class="co">#&gt;       region   month   metric actual expected</span>
<span class="co">#&gt; 1    Midwest October  returns    407      400</span>
<span class="co">#&gt; 2    Midwest October    sales   4446     4000</span>
<span class="co">#&gt; 3    Midwest October visitors     80      160</span>
<span class="co">#&gt; 4  Northeast October  returns    310      300</span>
<span class="co">#&gt; 5  Northeast October    sales   3023     5000</span>
<span class="co">#&gt; 6  Northeast October visitors     64       60</span>
<span class="co">#&gt; 7  Northwest October  returns    201      200</span>
<span class="co">#&gt; 8  Northwest October    sales   2228     2000</span>
<span class="co">#&gt; 9  Northwest October visitors     45       40</span>
<span class="co">#&gt; 10 Southeast October  returns    505      200</span>
<span class="co">#&gt; 11 Southeast October    sales   5264     5000</span>
<span class="co">#&gt; 12 Southeast October visitors    101      100</span>
<span class="co">#&gt; 13 Southwest October  returns    706      700</span>
<span class="co">#&gt; 14 Southwest October    sales   7276     4000</span>
<span class="co">#&gt; 15 Southwest October visitors    142      140</span></pre></body></html></div>
<p>After that, the process of identifying deviations and posting these
to a repository is the same as above.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Emily Riederer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'ebfdcb314b81d897faab364541561384',
    indexName: 'projmgr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
